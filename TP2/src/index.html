<!DOCTYPE html>
<html>
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
	<link rel="stylesheet" href="vendors/css/bootstrap.css">
	<link rel="stylesheet" href="vendors/css/font-awesome.min.css">	
	<script src="vendors/js/jquery-3.2.1.min.js"></script>
	<script src="vendors/js/d3.min.js"></script>
	<script src="vendors/js/bootstrap.min.js"></script>
	<script src="assets/js/parser.js"></script>
</head>

<body>

 <script>

var svgContainer = d3.select("body").append("svg")
                                     .attr("width", 1000)
                                     .attr("height", 1000);
 
function createPeduncle( x0, y0, x0Fl, y0Fl){

var line1 = svgContainer.append("line")
                          .attr("x1", x0)
                          .attr("y1", y0)
                          .attr("x2", x0Fl)
                          .attr("y2", y0Fl)
                          .attr("stroke-width", 4)
                          .attr("stroke", "#14320d");
}


function createPetal(x0, y0, v, rotation, color){

var line1 = svgContainer.append("line")
                          .attr("x1", x0)
                          .attr("y1", y0)
                          .attr("x2", x0+v)
                          .attr("y2", y0)
                          .attr("stroke-width", 8)
                          .attr("stroke", color)
                          .attr("transform", "rotate( "+rotation+" "+x0+" "+y0+")");

}

function createFlower(data, v, x0, y0, x0Fl, y0Fl){
	var auxSz = 5;
	createPeduncle(x0, y0, x0Fl, y0Fl);

	createPetal(x0Fl, y0Fl, v*data['civic engagement'], 2, '#4c9479');
	createPetal(x0Fl, y0Fl, v*data['community'], 35, '#4c94bb');
	createPetal(x0Fl, y0Fl, v*data['education'], 68, '#0004a0');
	createPetal(x0Fl, y0Fl, v*data['environment'], 101, '#a84550');
	createPetal(x0Fl, y0Fl, v*data['health'], 134, '#7ab536');
	createPetal(x0Fl, y0Fl, v*data['housing'], 167, '#13ad33');
	createPetal(x0Fl, y0Fl, v*data['income'], 200, '#debe1a');
	createPetal(x0Fl, y0Fl, v*data['jobs'], 233, '#774998');
	createPetal(x0Fl, y0Fl, v*data['life satisfaction'], 266, '#df390f');
	createPetal(x0Fl, y0Fl, v*data['safety'], 299, '#39372a');
	createPetal(x0Fl, y0Fl, v*data['work-life balance'], 332, '#5f0202');

	var circle = svgContainer.append("circle")
                         .attr("cx", x0Fl)
                         .attr("cy", y0Fl)
                         .attr("stroke-width", 3)
                         .attr("fill", "#b4a702")
                         .attr("stroke", "#e3ef02")
                         .attr("r", auxSz);

    var svgText = svgContainer.append("text").attr("x",-auxSz).attr("y",y0Fl-6)
    			.text(data['country'])
                .attr("transform", "rotate( 270 "+x0Fl+" "+y0Fl+")")
    			.attr("font-size","20px");
}

var flowerCenterX = 200; //deslocamento horizontal da flor
var flowerCenterY = 200; //altura da flor

var flowerPositionY0 = 500; 
var value = 60;

var dataset = [ 0.754861644,0.282924351,0.730612072,0.815217089,0.897851143,0.932635856,0.894405941844581,0.377191033,0.947379707317073,0.661864705,0.511786365 ];


//createFlower("name da flor", dataset, value, flowerCenterX, flowerPositionY0, flowerCenterX, flowerCenterY);
parsecsv("data/data.csv", function(data){
  createFlower(data, value, flowerCenterX, flowerPositionY0, flowerCenterX, flowerCenterY);});



</script>


</body>

</html>